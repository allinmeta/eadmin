{"version":3,"sources":["webpack:///./src/components/form/form.vue","webpack:///./src/components/form/form.vue?63fc","webpack:///./src/components/form/manyItem.vue","webpack:///./src/components/form/manyItem.vue?53e4","webpack:///./src/components/form/form.vue?8e13","webpack:///./src/hooks/use-http.ts","webpack:///./src/hooks/use-visible.ts","webpack:///./src/hooks/use-ajax.ts"],"names":["class","ref","label-position","labelPosition","$attrs","action","submit","loading","data","disabled","reset","resetForm","cancel","cancelForm","components","render","manyItem","inheritAttrs","name","props","Object","setAction","String","setActionMethod","type","default","slotProps","Boolean","validate","step","Number","watch","Array","exceptField","emits","setup","ctx","eadminForm","http","state","store","proxyData","validateStatus","val","sumbitForm","watchData","watchListen","copyData","JSON","parse","stringify","shift","value","watchAjax","field","newValue","oldValue","Promise","resolve","reject","url","method","form","attrs","model","eadmin_form_watch","eadmin_class","eadmin_function","then","res","showField","forEach","hideField","formData","f","assign","catch","emit","params","eadmin_validate","clearValidator","bool","submitData","key","indexOf","scrollIntoView","code","index","fields","split","validator","validatorField","replace","isError","document","getElementsByClassName","block","behavior","isArray","clearValidate","push","length","deep","device","resetFields","__scopeId","title","content-position","item","row","$index","size","plain","add","remove","handleUp","handleDown","modelValue","manyData","len","splice","finally","visible","show","callback","hide","useHttp","content","addParams"],"mappings":"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","file":"static/js/chunk-01814f02.477424b8.js","sourcesContent":["<template>\r\n    <el-main class='form'>\r\n    <el-form ref=\"eadminForm\" :label-position=\"labelPosition\" v-bind=\"$attrs\" @submit.native.prevent>\r\n        <slot></slot>\r\n        <el-form-item>\r\n            <slot name=\"leftAction\"></slot>\r\n            <render v-if=\"action.submit\" :loading=\"loading\" :data=\"action.submit\" :disabled=\"disabled\"></render>\r\n            <render v-if=\"action.reset\" :data=\"action.reset\" @click=\"resetForm\"></render>\r\n            <render v-if=\"action.cancel\" :data=\"action.cancel\" @click=\"cancelForm\"></render>\r\n            <slot name=\"rightAction\"></slot>\r\n        </el-form-item>\r\n    </el-form>\r\n    </el-main>\r\n</template>\r\n\r\n<script>\r\n    import {defineComponent, inject,nextTick,ref,watch,computed,isReactive} from 'vue'\r\n    import render from \"@/components/render.vue\"\r\n    import manyItem from \"./manyItem.vue\"\r\n    import { store } from '@/store'\r\n    import { useHttp } from '@/hooks'\r\n    import { forEach } from '@/utils'\r\n    import request from '@/utils/axios'\r\n    export default defineComponent({\r\n        components:{\r\n            render,manyItem\r\n        },\r\n        inheritAttrs: false,\r\n        name: \"EadminForm\",\r\n        props:{\r\n            action:Object,\r\n            //提交url\r\n            setAction: String,\r\n            setActionMethod:{\r\n                type:String,\r\n                default:'post'\r\n            },\r\n            slotProps:Object,\r\n            submit:Boolean,\r\n            validate:Boolean,\r\n            step:Number,\r\n            watch:{\r\n                type:Array,\r\n                default:[],\r\n            },\r\n            exceptField:{\r\n                type:Array,\r\n                default:[],\r\n            }\r\n        },\r\n        emits: ['success','gridRefresh','update:submit','update:validate','update:step','update:eadminForm'],\r\n        setup(props,ctx){\r\n            const eadminForm = ref(null)\r\n            const disabled = ref(false)\r\n            const {loading,http} = useHttp()\r\n            const state = inject(store)\r\n            const proxyData = state.proxyData\r\n            const validateStatus = ref(false)\r\n\r\n            //提交\r\n            watch(()=>props.submit,val=>{\r\n                if(val){\r\n                    sumbitForm()\r\n                }\r\n            })\r\n            //watch监听变化\r\n            const watchData = []\r\n            props.watch.forEach(field=>{\r\n                watchData.push({\r\n                    field:field,\r\n                    newValue:ctx.attrs.model[field],\r\n                    oldValue:ctx.attrs.model[field],\r\n                })\r\n                watch(()=>ctx.attrs.model[field],(newValue,oldValue)=>{\r\n                    const length = watchData.length\r\n                    watchData.push({\r\n                        field:field,\r\n                        newValue:newValue,\r\n                        oldValue:oldValue,\r\n                    })\r\n                    if(length === 0){\r\n                        watchListen()\r\n                    }\r\n                },{deep:true})\r\n            })\r\n            watchListen()\r\n            //监听watch变化数据队列执行\r\n            async function watchListen(){\r\n                const copyData = JSON.parse(JSON.stringify(watchData))\r\n                const data = copyData.shift()\r\n                disabled.value = true\r\n                if(data){\r\n                    await watchAjax(data.field,data.newValue,data.oldValue)\r\n                    watchData.shift()\r\n                    watchListen()\r\n                }else{\r\n                    disabled.value = false\r\n                }\r\n            }\r\n            //watch ajax请求\r\n            function watchAjax(field,newValue,oldValue){\r\n                return new Promise((resolve,reject) => {\r\n\r\n                    request({\r\n                        url: props.setAction,\r\n                        method: props.setActionMethod,\r\n                        data: {\r\n                            field:field,\r\n                            newValue:newValue,\r\n                            oldValue:oldValue,\r\n                            form:ctx.attrs.model,\r\n                            eadmin_form_watch:true,\r\n                            eadmin_class:ctx.attrs.model['eadmin_class'],\r\n                            eadmin_function:ctx.attrs.model['eadmin_function']\r\n                        }\r\n                    }).then(res=>{\r\n                        res.data.showField.forEach(field=>{\r\n                            proxyData[field] = 1\r\n                        })\r\n                        res.data.hideField.forEach(field=>{\r\n                            proxyData[field] = 0\r\n                        })\r\n                        let formData = res.data.form\r\n                        for(let f in formData){\r\n                            if(f == field && JSON.stringify(formData[f]) !== JSON.stringify(newValue)){\r\n                                if(isReactive(ctx.attrs.model[f])){\r\n                                    Object.assign(ctx.attrs.model[f],formData[f])\r\n                                }else{\r\n                                    ctx.attrs.model[f] = formData[f]\r\n                                }\r\n                            }else if(f != field && ctx.attrs.model[f] != formData[f]){\r\n                                if(isReactive(ctx.attrs.model[f])){\r\n                                    Object.assign(ctx.attrs.model[f],formData[f])\r\n                                }else{\r\n                                    ctx.attrs.model[f] = formData[f]\r\n                                }\r\n                            }\r\n                        }\r\n                        resolve(res)\r\n                    }).catch((res)=>{\r\n                        resolve(res)\r\n                    })\r\n                })\r\n            }\r\n            //校验\r\n            watch(()=>props.validate,val=>{\r\n                if(val){\r\n                    ctx.emit('update:validate',false)\r\n                    sumbitForm(true)\r\n                }\r\n            })\r\n            watch(validateStatus,val=>{\r\n                if(val){\r\n                    validateStatus.value = false\r\n                    ctx.emit('update:step',++props.step)\r\n                }\r\n            })\r\n            //提交\r\n            function sumbitForm(validate=false) {\r\n                ctx.emit('update:submit',false)\r\n                let params = {}\r\n                if(validate){\r\n                    params.eadmin_validate = true\r\n                }\r\n                if(props.setAction){\r\n                    clearValidator()\r\n                    eadminForm.value.validate(bool=>{\r\n                        const submitData = JSON.parse(JSON.stringify(ctx.attrs.model))\r\n                        forEach(submitData,function (val,key) {\r\n                            if(props.exceptField.indexOf(key) > -1){\r\n                                delete submitData[key]\r\n                            }\r\n                        })\r\n                        if(bool){\r\n                            http({\r\n                                url: props.setAction,\r\n                                params:params,\r\n                                method: props.setActionMethod,\r\n                                data: submitData\r\n                            }).then(res=>{\r\n                                if(res.code === 422){\r\n                                    for (let field in res.data){\r\n                                        if(res.index){\r\n                                            let fields = field.split('.')\r\n                                            let name = fields.shift()\r\n                                            let f = fields.shift()\r\n                                            if(!proxyData[ctx.attrs.validator][name]){\r\n                                                proxyData[ctx.attrs.validator][name] = []\r\n                                            }\r\n                                            if(!proxyData[ctx.attrs.validator][name][res.index]){\r\n                                                proxyData[ctx.attrs.validator][name][res.index] = {}\r\n                                            }\r\n                                            proxyData[ctx.attrs.validator][name][res.index][f] = res.data[field]\r\n                                        }else{\r\n                                            const validatorField = field.replace('.','_')\r\n                                            proxyData[ctx.attrs.validator][validatorField] = res.data[field]\r\n                                        }\r\n                                    }\r\n                                    scrollIntoView()\r\n                                }else  if(res.code === 412){\r\n                                    validateStatus.value = true\r\n                                }else{\r\n                                    ctx.emit('success')\r\n                                    ctx.emit('gridRefresh')\r\n                                }\r\n                            })\r\n                        }else{\r\n                            scrollIntoView()\r\n                            return false\r\n                        }\r\n                    })\r\n                }else{\r\n                    validateStatus.value = true\r\n                    ctx.emit('update:submit',false)\r\n                    ctx.emit('success')\r\n                    ctx.emit('gridRefresh')\r\n                }\r\n            }\r\n            //滚动到校验错误处\r\n            function scrollIntoView() {\r\n                nextTick(()=>{\r\n                    let isError  = document.getElementsByClassName('is-error')\r\n                    if(isError){\r\n                        isError[0].scrollIntoView({\r\n                            block: 'center',\r\n                            behavior: 'smooth'\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n            //清除校验结果\r\n            function clearValidator() {\r\n                for (let field in proxyData[ctx.attrs.validator]){\r\n                    let value = proxyData[ctx.attrs.validator][field]\r\n                    if(Array.isArray(value)){\r\n                        proxyData[ctx.attrs.validator][field] = []\r\n                    }else{\r\n                        proxyData[ctx.attrs.validator][field] = ''\r\n                    }\r\n                }\r\n                eadminForm.value.clearValidate()\r\n            }\r\n            const labelPosition = computed(()=>{\r\n                if(state.device === 'mobile'){\r\n                    return 'top'\r\n                }else{\r\n                    return 'right'\r\n                }\r\n            })\r\n            //重置\r\n            function resetForm() {\r\n                clearValidator()\r\n                eadminForm.value.resetFields();\r\n            }\r\n            //取消\r\n            function cancelForm(){\r\n                ctx.emit('success')\r\n            }\r\n            return {\r\n                disabled,\r\n                eadminForm,\r\n                loading,\r\n                resetForm,\r\n                cancelForm,\r\n                labelPosition,\r\n            }\r\n        }\r\n    })\r\n</script>\r\n\r\n<style scoped>\r\n.form{\r\n    background: rgb(255, 255, 255);\r\n    border-radius: 4px;\r\n    white-space:normal;\r\n}\r\n</style>\r\n","import { render } from \"./form.vue?vue&type=template&id=659fa7dd&scoped=true\"\nimport script from \"./form.vue?vue&type=script&lang=js\"\nexport * from \"./form.vue?vue&type=script&lang=js\"\n\nimport \"./form.vue?vue&type=style&index=0&id=659fa7dd&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-659fa7dd\"\n\nexport default script","<template>\r\n    <el-divider content-position='left' v-if=\"title\">{{title}}</el-divider>\r\n    <div v-for=\"(item,index) in value\">\r\n        <slot :row=\"item\" :$index=\"index\" :prop-field=\"field\" :validator=\"$attrs.validator\"></slot>\r\n        <el-form-item v-if=\"!disabled\">\r\n            <el-button size=\"mini\" v-if=\"value.length - 1 == index\" type='primary' plain @click=\"add\">新增</el-button>\r\n            <el-button size=\"mini\" type='danger' v-show='value.length > 0' @click=\"remove(index)\">移除</el-button>\r\n            <el-button size=\"mini\" @click=\"handleUp(index)\" v-show='value.length > 1 && index > 0'>上移</el-button>\r\n            <el-button size=\"mini\" v-show='value.length > 1 && index < value.length-1' @click=\"handleDown(index)\">下移</el-button>\r\n        </el-form-item>\r\n    </div>\r\n    <el-form-item v-if=\"value.length == 0 && !disabled\">\r\n         <el-button size=\"mini\" type='primary' plain @click=\"add\">新增</el-button>\r\n    </el-form-item>\r\n</template>\r\n\r\n<script>\r\n    import {defineComponent,reactive,watch} from \"vue\";\r\n    export default defineComponent({\r\n        name: \"EadminManyItem\",\r\n        props: {\r\n            title:String,\r\n            modelValue: Array,\r\n            field:String,\r\n            manyData:Object,\r\n            disabled:Boolean,\r\n        },\r\n        emits:['update:modelValue'],\r\n        setup(props,ctx){\r\n            const value = reactive(props.modelValue)\r\n            watch(value,(val)=>{\r\n                ctx.emit('update:modelValue',val)\r\n            })\r\n            // 上移\r\n            function handleUp (index) {\r\n                const len = value[index - 1]\r\n                value[index - 1] = value[index]\r\n                value[index] = len\r\n            }\r\n            // 下移\r\n            function handleDown (index) {\r\n                const len = value[index + 1]\r\n                value[index + 1] = value[index]\r\n                value[index] = len\r\n            }\r\n            //添加元素\r\n            function add(){\r\n                value.push({...props.manyData})\r\n            }\r\n            //移除元素\r\n            function remove(index){\r\n                value.splice(index, 1)\r\n            }\r\n            return {\r\n                value,\r\n                add,\r\n                remove,\r\n                handleUp,\r\n                handleDown,\r\n            }\r\n        }\r\n    })\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./manyItem.vue?vue&type=template&id=2cc71014&scoped=true\"\nimport script from \"./manyItem.vue?vue&type=script&lang=js\"\nexport * from \"./manyItem.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-2cc71014\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./form.vue?vue&type=style&index=0&id=659fa7dd&scoped=true&lang=css\"","import request from '@/utils/axios'\r\nimport {ref} from \"vue\"\r\nconst useHttp =  function () {\r\n    const loading = ref(false)\r\n    const http =  function (params:object) {\r\n        return new Promise((resolve, reject) =>{\r\n            loading.value = true\r\n            request(params).then((res:any)=>{\r\n                resolve(res)\r\n            }).catch((res:any)=>{\r\n                reject(res)\r\n            }).finally(()=>{\r\n                loading.value = false\r\n            })\r\n        })\r\n    }\r\n    return {loading,http}\r\n}\r\nexport default useHttp\r\n","import {ref,watch} from \"vue\";\r\nimport request from '@/utils/axios'\r\nconst useVisible = function(props:object,ctx:any){\r\n    const visible = ref(false)\r\n    watch(visible,(value)=>{\r\n        ctx.emit('update:modelValue',value)\r\n        ctx.emit('update:show',value)\r\n    })\r\n    function show(callback:any){\r\n        visible.value = true\r\n        if(callback){\r\n            callback()\r\n        }\r\n    }\r\n    function hide(callback:any){\r\n        visible.value = false\r\n        if(callback){\r\n            callback()\r\n        }\r\n    }\r\n    function useHttp() {\r\n        const content = ref('')\r\n        const http = function (props) {\r\n            return new Promise((resolve, reject) =>{\r\n                if (props.url) {\r\n                    request({\r\n                        url: props.url,\r\n                        params:Object.assign(props.params,props.addParams),\r\n                        method:props.method\r\n                    }).then((res:any)=> {\r\n                        resolve(res)\r\n                        visible.value = true\r\n                        content.value = res\r\n                    }).catch((res:any)=>{\r\n                        reject(res)\r\n                    })\r\n                }else{\r\n                    visible.value = true\r\n                    resolve()\r\n                }\r\n            })\r\n        }\r\n        return {content,http}\r\n    }\r\n    return {visible,show,hide,useHttp}\r\n}\r\nexport default useVisible\r\n\r\n","import request from '@/utils/axios'\r\nimport {ref} from \"vue\"\r\nconst useAjax =  function () {\r\n    const loading = ref(false)\r\n    const http =  function ( ctx :any) {\r\n        if (ctx.attrs.url) {\r\n            loading.value = true\r\n            request({\r\n                url: ctx.attrs.url,\r\n                method: ctx.attrs.method || 'post',\r\n                data: ctx.attrs.params\r\n            }).then((res:any) => {\r\n                ctx.emit('gridRefresh')\r\n            }).finally(()=>{\r\n                loading.value = false\r\n            })\r\n        }\r\n    }\r\n    return {loading,http}\r\n}\r\n\r\nexport default useAjax\r\n"],"sourceRoot":""}