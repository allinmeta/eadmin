{"version":3,"sources":["webpack:///./src/components/selectTable.vue?4edb","webpack:///./src/hooks/use-http.ts","webpack:///./src/hooks/use-visible.ts","webpack:///./src/hooks/use-ajax.ts","webpack:///./src/components/selectTable.vue","webpack:///./src/components/selectTable.vue?dc1e"],"names":["loading","http","params","Promise","resolve","reject","value","then","res","catch","finally","props","ctx","visible","show","callback","hide","useHttp","content","url","Object","assign","addParams","method","emit","attrs","data","style","$attrs","multiple","focus","ref","value-key","options","item","key","id","label","selectLoading","icon","type","plain","open","append-to-body","width","destroy-on-close","footer","class","selection","length","submit","scroll","height","add-params","selection-type","name","modelValue","String","Array","Number","remoteParams","Boolean","inheritAttrs","emits","setup","select","isArray","y","window","innerHeight","eadminSelectTable","eadmin_id","selects","forEach","push","val","pop","blur","render","__scopeId"],"mappings":"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","file":"static/js/chunk-b11ad108.b8a7e60d.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./selectTable.vue?vue&type=style&index=0&id=d7956900&scoped=true&lang=css\"","import request from '@/utils/axios'\r\nimport {ref} from \"vue\"\r\nconst useHttp =  function () {\r\n    const loading = ref(false)\r\n    const http =  function (params:object) {\r\n        return new Promise((resolve, reject) =>{\r\n            loading.value = true\r\n            request(params).then((res:any)=>{\r\n                resolve(res)\r\n            }).catch((res:any)=>{\r\n                reject(res)\r\n            }).finally(()=>{\r\n                loading.value = false\r\n            })\r\n        })\r\n    }\r\n    return {loading,http}\r\n}\r\nexport default useHttp\r\n","import {ref,watch} from \"vue\";\r\nimport request from '@/utils/axios'\r\nconst useVisible = function(props:object,ctx:any){\r\n    const visible = ref(false)\r\n    watch(visible,(value)=>{\r\n        ctx.emit('update:modelValue',value)\r\n        ctx.emit('update:show',value)\r\n    })\r\n    function show(callback:any){\r\n        visible.value = true\r\n        if(callback){\r\n            callback()\r\n        }\r\n    }\r\n    function hide(callback:any){\r\n        visible.value = false\r\n        if(callback){\r\n            callback()\r\n        }\r\n    }\r\n    function useHttp() {\r\n        const content = ref('')\r\n        const http = function (props) {\r\n            return new Promise((resolve, reject) =>{\r\n                if (props.url) {\r\n                    request({\r\n                        url: props.url,\r\n                        params:Object.assign(props.params,props.addParams),\r\n                        method:props.method\r\n                    }).then((res:any)=> {\r\n                        resolve(res)\r\n                        visible.value = true\r\n                        content.value = res\r\n                    }).catch((res:any)=>{\r\n                        reject(res)\r\n                    })\r\n                }else{\r\n                    visible.value = true\r\n                    resolve()\r\n                }\r\n            })\r\n        }\r\n        return {content,http}\r\n    }\r\n    return {visible,show,hide,useHttp}\r\n}\r\nexport default useVisible\r\n\r\n","import request from '@/utils/axios'\r\nimport {ref} from \"vue\"\r\nconst useAjax =  function () {\r\n    const loading = ref(false)\r\n    const http =  function ( ctx :any) {\r\n        if (ctx.attrs.url) {\r\n            loading.value = true\r\n            request({\r\n                url: ctx.attrs.url,\r\n                method: ctx.attrs.method || 'post',\r\n                data: ctx.attrs.params\r\n            }).then((res:any) => {\r\n                ctx.emit('gridRefresh')\r\n            }).finally(()=>{\r\n                loading.value = false\r\n            })\r\n        }\r\n    }\r\n    return {loading,http}\r\n}\r\n\r\nexport default useAjax\r\n","<template>\r\n    <div style=\"display: flex;align-items: center\">\r\n        <el-select style=\"flex: 1\" v-bind=\"$attrs\" v-model=\"value\" :multiple=\"multiple\" @focus=\"focus\" @click=\"focus\" ref=\"select\" value-key=\"id\" v-loading=\"selectLoading\">\r\n            <el-option\r\n                    v-for=\"item in options\"\r\n                    :key=\"item.id\"\r\n                    :label=\"item.label\"\r\n                    :value=\"item.id\">\r\n            </el-option>\r\n        </el-select>\r\n        <el-button icon=\"el-icon-plus\" type=\"primary\" plain style=\"margin-left: 5px;height: 36px\" @click=\"open\"></el-button>\r\n        <el-dialog v-model=\"visible\" :append-to-body=\"true\" width=\"70%\" destroy-on-close>\r\n            <div v-loading=\"loading\">\r\n                <render  :data=\"content\" v-model:selection=\"selection\" :scroll=\"height\" :add-params=\"params\"\r\n                        :selection-type=\"multiple ? 'checkbox':'radio'\" style=\"overflow-x:auto\"></render>\r\n            </div>\r\n            <template #footer>\r\n                <div :class=\"multiple && selection.length > 0 ? 'footer':''\">\r\n                    <div v-if=\"multiple && selection.length > 0\">已选中: {{selection.length}}</div>\r\n                    <div>\r\n                        <el-button type=\"primary\" @click=\"submit\">确认</el-button>\r\n                        <el-button @click=\"visible = false\">取消</el-button>\r\n                    </div>\r\n                </div>\r\n            </template>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {defineComponent, ref, watch} from \"vue\";\r\n    import {useHttp} from '@/hooks'\r\n\r\n\r\n    export default defineComponent({\r\n        name: \"EadminSelectTable\",\r\n        props: {\r\n            modelValue: [String, Array, Number],\r\n            params: Object,\r\n            remoteParams: Object,\r\n            multiple: Boolean\r\n        },\r\n        inheritAttrs: false,\r\n        emits: ['update:modelValue'],\r\n        setup(props, ctx) {\r\n            const selectLoading = ref(true)\r\n            const select = ref('')\r\n            const value = ref(props.modelValue)\r\n            const visible = ref(false)\r\n            const options = ref([])\r\n            const selection = ref(props.modelValue || [])\r\n            const content = ref('')\r\n            if(!Array.isArray(selection.value)){\r\n                selection.value = [selection.value]\r\n            }\r\n            const {loading, http} = useHttp()\r\n            const height = {\r\n                y: window.innerHeight / 2\r\n            }\r\n            submit()\r\n            watch(() => props.modelValue, val => {\r\n                value.value = val\r\n            })\r\n            watch(value, (val) => {\r\n                if (props.multiple) {\r\n                    selection.value = val\r\n                } else {\r\n                    if(val){\r\n                        selection.value = [val]\r\n                    }else{\r\n                        selection.value = []\r\n                    }\r\n                }\r\n                ctx.emit('update:modelValue', val)\r\n            })\r\n            function open() {\r\n                content.value = null\r\n                visible.value = true\r\n                http({\r\n                    url: '/eadmin.rest',\r\n                    params: props.params\r\n                }).then(res => {\r\n                    content.value = res\r\n                })\r\n            }\r\n\r\n            function submit() {\r\n                const {http} = useHttp()\r\n                http({\r\n                    url: '/eadmin.rest',\r\n                    params: Object.assign(props.remoteParams, {eadminSelectTable: true, eadmin_id: selection.value}),\r\n                }).then(res => {\r\n                    options.value = res.data\r\n                    visible.value = false\r\n                    const selects = []\r\n                    selection.value.forEach(item => {\r\n                        selects.push(item)\r\n                    })\r\n                    if (props.multiple) {\r\n                        value.value = selects\r\n                    } else {\r\n                        let val  = selects.pop()\r\n                        if(typeof(val) !== 'undefined'){\r\n                            value.value = val\r\n                        }\r\n                        select.value.focus()\r\n                    }\r\n                }).finally(()=>{\r\n                    selectLoading.value = false\r\n                })\r\n            }\r\n            function focus() {\r\n                select.value.blur()\r\n            }\r\n            return {\r\n                selectLoading,\r\n                loading,\r\n                submit,\r\n                open,\r\n                focus,\r\n                content,\r\n                options,\r\n                value,\r\n                selection,\r\n                visible,\r\n                select,\r\n                height\r\n            }\r\n        }\r\n    })\r\n</script>\r\n\r\n<style scoped>\r\n    .footer{\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n    }\r\n</style>\r\n","import { render } from \"./selectTable.vue?vue&type=template&id=d7956900&scoped=true\"\nimport script from \"./selectTable.vue?vue&type=script&lang=js\"\nexport * from \"./selectTable.vue?vue&type=script&lang=js\"\n\nimport \"./selectTable.vue?vue&type=style&index=0&id=d7956900&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-d7956900\"\n\nexport default script"],"sourceRoot":""}